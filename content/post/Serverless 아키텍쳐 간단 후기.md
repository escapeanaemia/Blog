---
title: "Serverless 아키텍쳐 간단 후기"
date: 2019-11-15T01:28:41+09:00
draft : false
categories : ["Serverless architecture"]
tags : ["Serverless", "Cloud computing", "서버리스"]
author : ["jeonghyun"]
---
# 서버리스란
서버리스란 개발자가 서버 하드웨어를 관리할 필요 없이 코드에만 집중할 수 있는 아키텍쳐입니다. 서버리스를 사용하여 개발자는 기능을 함수 단위로 쪼개 마이크로서비스로 운영할 수 있습니다.

서버리스는 Backend As A Service(BAAS)와 Function As A Service(FAAS)를 총칭하는 용어입니다. BAAS의 대표적인 예로는 Google Firebase가 있으며, FAAS로는 Azure Functions, AWS Lambda 등이 있습니다.


# 왜 서버리스를 선택했는가
예전에는 간단한 프로젝트라도 AWS EC2와 같은 가상 머신에 서버를 배포했었습니다. 하지만 이러한 가상 머신은 사용 시간에 따라 가격이 책정됐기 때문에, 저같은 학생 입장에서 부담스러웠습니다. 또한, 타인에게 실제 서비스를 제공할 때 내가 직접 서버를 관리한다는게 뭔가 모르게 불안하기도 했습니다.

반면 서버리스는 접속 수와 실행 시간에 따라 요금이 청구됩니다. 요청 수가 별로 없으며 복잡한 계산이 없는 소규모 서비스에서 더할 나위 없이 좋은 서비스입니다. 게다가 AWS기준 한달에 요청 횟수가 백만 번 이하일 경우 플랫폼을 무료로 제공합니다. 제가 운영하는 소규모 서비스는 보통 한달 총 요청 횟수가 많아야 2만~3만번 정도이니 **서버리스를 사용하면 무료로 이용할 수 있는 것입니다.**

또한 플랫폼 제공사에서 서버를 관리하고, 거기에 데이터베이스나 로그도 제공하기 때문에, 구축 과정에서 혹시나 모를 실수를 했을까 걱정할 필요도 없고 구축 작업에 비교적 오랜 시간을 쏟을 필요가 없게 되었습니다.

**서버리스의 특징**

* 비용이 덜 들음.
* 서버 컴퓨터를 관리할 필요가 없음.
* 접속자가 적은 소규모 서비스의 경우 비용을 획기적으로 절감할 수 있음.


# *개인적으로* 느낀 각 플랫폼별 특징
공모전이나 조그마한 개인 프로젝트를 운영하면서 개인적으로 느낀 점입니다. Firebase는 사용 경험이 거의 없어서 적지 않았습니다.


## AWS Lambda
* 프로그래밍 언어별로 AWS SDK를 제공하여 AWS의 다른 서비스들과의 연동이 아주 좋다.
* 서버리스 플랫폼중에서 가장 인기가 많다보니 관련 자료나 Q&A가 풍부하다.
* Azure와는 달리 SSL/TLS 인증서가 무료로 제공된다.
* 정확히는 모르겠지만 콜드스타트가 Azure Functions에 비해 좀 더 빠른것같다.


## Azure Functions
* Visual Studio Code와 궁합이 좋다.
* `create-react-app`처럼 공식적으로 손쉬운 셋업 도구를 제공하여 구조(함수에 주어지는 파라미터 등)를 빨리 익힐 수 있다.
* 운영체를 리눅스와 윈도우 중에서 선택할 수 있다. 근데 리눅스를 선택할 경우 제공되는 플랜 유형이 App Service(호스팅 시간에 따른 가격 책정)밖에 없다.
* 도커 이미지로 배포가 가능하다. 근데 이럴 경우 운영체제를 리눅스밖에 선택할 수 없고, 때문에 App Service 요금으로 청구된다.
* 또한 도커 컨테이너 배포가 아니더라도 런타임 스택이 파이썬이라면 리눅스밖에 선택할 수 없고, App Service 요금으로 청구된다.
* 콘솔 UI가 AWS Lambda 보다 이쁘다.


# 서버리스의 한계
서버리스는 매 호출 때마다 상태를 가지고 있지 않습니다. 때문에 세션 정보를 메모리에 저장하는 등 메모리 상에 상태를 가져야 하는 작업은 서버리스로 구축하는 것이 적합하지 않습니다.

제가 한창 서버리스를 사용할 때 웹소켓 채팅 서버를 서버리스로 배포하려고 했었습니다. 그러나 웹소켓은 한 번의 핸드쉐이크로 클라이언트와의 연결 상태를 가지고 있어야하기 때문에, 서버리스를 포기하고 EC2로 배포한 경험이 있습니다.

호출을 완료하고 나면 함수는 잠깐 동안의 대기 상태를 가진 후(AWS의 경우 대략 3~40분 정도) 완전히 내려갑니다. [이 잠깐의 대기시간을 이용하여 DB 접속 정보를 재사용한 예도 있습니다.](https://velopert.com/3577#%EC%A0%91%EC%86%8D%EC%A0%95%EB%B3%B4-%EC%9E%AC%EC%82%AC%EC%9A%A9%ED%95%98%EA%B8%B0)


# 마무리
여태껏 저는 간단한 서비스 위주로 서버리스 아키텍처를 사용해 왔습니다. 앞으로 비교적 대규모 서비스를 개발할 때 마이크로서비스로 구현할 경우 각자의 함수를 독립적으로 테스트하고 실행하여 훨씬 용이한 개발이 가능할 것으로 기대됩니다. 다만 서버리스 아키텍처는 앞서 말한 여러 한계가 있기 때문에, 프로젝트에 사용할 기술 요구사항을 살펴본 후 어떤 아키텍처를 선택할 지 고민할 필요가 있다고 생각합니다.

또한 앞서 말했듯이 Azure Functions의 경우 런타임에 따른 요금제 제약이 심하기 때문에 이또한 자세히 알아볼 필요가 있습니다.

마지막으로, 개인적인 경험과 비교적 짧은 견해가 담긴 글이니 잘못된 부분이 있으면 댓글로 알려주시면 감사하겠습니다.


# 참고
https://dashbird.io/blog/can-we-solve-serverless-cold-starts/

https://velog.io/@jerrynim_/serverless-stack-%EC%86%8C%EA%B0%9C-69jyihmqxg

https://velopert.com/3543